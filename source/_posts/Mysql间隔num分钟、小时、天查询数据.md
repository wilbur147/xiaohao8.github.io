---
title: Mysql间隔num分钟、小时、天查询数据
date: 2021-09-15 21:13:37
updated: 2021-09-15 21:13:37
categories:
  - 疑难杂症
comments: true
---
有时候在项目中遇到需要间隔5条或者10条数据查一条，又或者间隔5分钟,5小时查一条这种数据，自此本文记录一下sql，废话不多说，上代码。



```mysql
SELECT     
	d.time as eq_time,
	-- 按num分钟
	CONCAT(
	DATE_FORMAT(d.time, '%Y%m%d%H'),
	LPAD(FLOOR(DATE_FORMAT(d.time, '%i') / #{num}) * 3,2,'0')
	) time
	-- -- 按3小时
	-- CONCAT(
	-- DATE_FORMAT(d.time, '%Y%m%d'),
	-- LPAD(FLOOR(DATE_FORMAT(d.time, '%H') / 3) * 3,2,'0'),
	-- '00'
	-- ) time
	-- -- 按3天
	-- CONCAT(
	-- DATE_FORMAT(d.time, '%Y%m'),
	-- LPAD(FLOOR(DATE_FORMAT(d.time, '%d') / 3) * 3 + 1,2,'0'),
	-- '0000'
	-- ) time
	FROM
	t_table d
	GROUP BY
	time
```



以上代码我测试了一下5分钟间隔查一条数据，结果：

| eq_time             | time         |
| ------------------- | ------------ |
| 2021-09-06 17:45:06 | 202109061727 |
| 2021-09-06 18:40:32 | 202109061824 |
| 2021-09-07 10:06:04 | 202109071003 |
| 2021-09-07 10:10:34 | 202109071006 |
| 2021-09-07 10:15:04 | 202109071006 |
| 2021-09-07 10:21:07 | 202109071006 |
| 2021-09-07 10:25:34 | 202109071015 |
| 2021-09-07 10:30:04 | 202109071018 |
| 2021-09-07 10:36:04 | 202109071021 |

**因为我测试的表数据每条数据是隔一分半才添加的一条，所以会有部分不会是整的5分钟间隔**



觉得有用的话就点个赞分享一下，有什么问题可以评论区留言~~~~~



